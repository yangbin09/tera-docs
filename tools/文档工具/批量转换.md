# æ‰¹é‡è½¬æ¢è„šæœ¬ä½¿ç”¨æŒ‡å—

## ğŸ“– æ¦‚è¿°

æœ¬å·¥å…·æä¾›äº†ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æ‰¹é‡è½¬æ¢è„šæœ¬ï¼Œå¯ä»¥å°†ç›®å½•ä¸‹æ‰€æœ‰çš„ Word æ–‡æ¡£ï¼ˆ.doc, .docxï¼‰æ‰¹é‡è½¬æ¢ä¸º Markdown æ ¼å¼ã€‚è„šæœ¬ä½¿ç”¨ `markitdown` åº“è¿›è¡Œè½¬æ¢ï¼Œä¿æŒåŸæœ‰çš„ç›®å½•ç»“æ„ã€‚

## ğŸ”§ è„šæœ¬åŠŸèƒ½

### ä¸»è¦ç‰¹æ€§
- **æ‰¹é‡å¤„ç†**: è‡ªåŠ¨æŸ¥æ‰¾å¹¶è½¬æ¢ç›®å½•ä¸‹æ‰€æœ‰ Word æ–‡ä»¶
- **ç›®å½•ç»“æ„ä¿æŒ**: è½¬æ¢åä¿æŒåŸæœ‰çš„æ–‡ä»¶å¤¹ç»“æ„
- **è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºè½¬æ¢è¿›åº¦å’Œç»“æœ
- **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯
- **è‡ªåŠ¨åˆ›å»ºç›®å½•**: è‡ªåŠ¨åˆ›å»ºè¾“å‡ºç›®å½•

### æ”¯æŒæ ¼å¼
- `.doc` - Microsoft Word 97-2003 æ–‡æ¡£
- `.docx` - Microsoft Word 2007+ æ–‡æ¡£

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿å·²å®‰è£…å¿…è¦çš„ä¾èµ–ï¼š

```bash
# å®‰è£… markitdown åº“
pip install markitdown

# æˆ–è€…ä½¿ç”¨æŒ‡å®šçš„ Python è·¯å¾„
C:\Users\16922\AppData\Local\Programs\Python\Python312\python.exe -m pip install markitdown
```

### 2. è„šæœ¬ä½¿ç”¨

#### æ–¹æ³•ä¸€ï¼šç›´æ¥è¿è¡Œ
```bash
# åœ¨åŒ…å« Word æ–‡ä»¶çš„ç›®å½•ä¸­è¿è¡Œ
python auto_convert_word_to_md.py
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨å®Œæ•´è·¯å¾„
```bash
# ä½¿ç”¨å®Œæ•´çš„ Python è·¯å¾„
C:\Users\16922\AppData\Local\Programs\Python\Python312\python.exe auto_convert_word_to_md.py
```

### 3. è¿è¡Œç¤ºä¾‹

```
============================================================
è‡ªåŠ¨æ‰¹é‡ Word æ–‡ä»¶è½¬ Markdown å·¥å…·
============================================================
å½“å‰å·¥ä½œç›®å½•: D:\BaiduNetdiskDownload\prompt-test

æ­£åœ¨æŸ¥æ‰¾ Word æ–‡ä»¶...
âœ… æ‰¾åˆ° 15 ä¸ª Word æ–‡ä»¶

å¼€å§‹è‡ªåŠ¨è½¬æ¢ï¼Œè¾“å‡ºç›®å½•: D:\BaiduNetdiskDownload\prompt-test\converted_markdown
------------------------------------------------------------
[1/15] è½¬æ¢: 1ï¼ŒAIå†™å°è¯´æŒ‡ä»¤ã€æŒ‡ä»¤+æ•™ç¨‹ã€‘\AIå†™å°è¯´.docx
  âœ… æˆåŠŸ -> converted_markdown\1ï¼ŒAIå†™å°è¯´æŒ‡ä»¤ã€æŒ‡ä»¤+æ•™ç¨‹ã€‘\AIå†™å°è¯´.md
[2/15] è½¬æ¢: 2ï¼Œå°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆã€æŒ‡ä»¤+æ•™ç¨‹ã€‘\å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆ.docx
  âœ… æˆåŠŸ -> converted_markdown\2ï¼Œå°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆã€æŒ‡ä»¤+æ•™ç¨‹ã€‘\å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆ.md
...
------------------------------------------------------------
è½¬æ¢å®Œæˆ!
âœ… æˆåŠŸ: 14 ä¸ªæ–‡ä»¶
âŒ å¤±è´¥: 1 ä¸ªæ–‡ä»¶

å¤±è´¥çš„æ–‡ä»¶:
  - æŸä¸ªæ–‡ä»¶.docx: æ–‡ä»¶å·²æŸåæˆ–æ ¼å¼ä¸æ”¯æŒ

æ‰€æœ‰è½¬æ¢çš„ Markdown æ–‡ä»¶ä¿å­˜åœ¨: D:\BaiduNetdiskDownload\prompt-test\converted_markdown
```

## ğŸ“ è¾“å‡ºç»“æ„

è„šæœ¬ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º `converted_markdown` æ–‡ä»¶å¤¹ï¼Œå¹¶ä¿æŒåŸæœ‰çš„ç›®å½•ç»“æ„ï¼š

```
å½“å‰ç›®å½•/
â”œâ”€â”€ auto_convert_word_to_md.py
â”œâ”€â”€ 1ï¼ŒAIå†™å°è¯´æŒ‡ä»¤ã€æŒ‡ä»¤+æ•™ç¨‹ã€‘/
â”‚   â””â”€â”€ AIå†™å°è¯´.docx
â”œâ”€â”€ 2ï¼Œå°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆã€æŒ‡ä»¤+æ•™ç¨‹ã€‘/
â”‚   â””â”€â”€ å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆ.docx
â””â”€â”€ converted_markdown/          # è¾“å‡ºç›®å½•
    â”œâ”€â”€ 1ï¼ŒAIå†™å°è¯´æŒ‡ä»¤ã€æŒ‡ä»¤+æ•™ç¨‹ã€‘/
    â”‚   â””â”€â”€ AIå†™å°è¯´.md
    â””â”€â”€ 2ï¼Œå°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆã€æŒ‡ä»¤+æ•™ç¨‹ã€‘/
        â””â”€â”€ å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆ.md
```

## ğŸ”§ è„šæœ¬è¯¦è§£

### æ ¸å¿ƒå‡½æ•°

#### 1. `find_word_files(directory)`
- **åŠŸèƒ½**: é€’å½’æŸ¥æ‰¾ç›®å½•ä¸‹æ‰€æœ‰ Word æ–‡ä»¶
- **å‚æ•°**: `directory` - è¦æœç´¢çš„ç›®å½•è·¯å¾„
- **è¿”å›**: Word æ–‡ä»¶è·¯å¾„åˆ—è¡¨

#### 2. `convert_word_to_markdown(word_file_path, output_dir)`
- **åŠŸèƒ½**: å°†å•ä¸ª Word æ–‡ä»¶è½¬æ¢ä¸º Markdown
- **å‚æ•°**: 
  - `word_file_path` - Word æ–‡ä»¶è·¯å¾„
  - `output_dir` - è¾“å‡ºç›®å½•ï¼ˆå¯é€‰ï¼‰
- **è¿”å›**: (è¾“å‡ºæ–‡ä»¶è·¯å¾„, æˆåŠŸæ ‡å¿—, é”™è¯¯ä¿¡æ¯)

#### 3. `main()`
- **åŠŸèƒ½**: ä¸»ç¨‹åºå…¥å£ï¼Œåè°ƒæ•´ä¸ªè½¬æ¢æµç¨‹
- **æµç¨‹**:
  1. æŸ¥æ‰¾ Word æ–‡ä»¶
  2. åˆ›å»ºè¾“å‡ºç›®å½•
  3. æ‰¹é‡è½¬æ¢
  4. æ˜¾ç¤ºç»“æœç»Ÿè®¡

### å…³é”®ç‰¹æ€§

#### ç›®å½•ç»“æ„ä¿æŒ
```python
# ä¿æŒç›®å½•ç»“æ„
rel_dir = os.path.dirname(rel_path)
output_dir = os.path.join(output_base_dir, rel_dir) if rel_dir else output_base_dir
os.makedirs(output_dir, exist_ok=True)
```

#### é”™è¯¯å¤„ç†
```python
try:
    # è½¬æ¢é€»è¾‘
    result = md.convert(word_file_path)
    return output_file, True, None
except Exception as e:
    return None, False, str(e)
```

## ğŸ› ï¸ è‡ªå®šä¹‰ä¿®æ”¹

### 1. ä¿®æ”¹è¾“å‡ºç›®å½•

```python
# åœ¨ main() å‡½æ•°ä¸­ä¿®æ”¹è¿™ä¸€è¡Œ
output_base_dir = os.path.join(current_dir, "my_custom_output")
```

### 2. æ·»åŠ æ›´å¤šæ–‡ä»¶æ ¼å¼

```python
# åœ¨ find_word_files() å‡½æ•°ä¸­ä¿®æ”¹
word_extensions = ['.doc', '.docx', '.rtf', '.odt']  # æ·»åŠ æ›´å¤šæ ¼å¼
```

### 3. è‡ªå®šä¹‰æ–‡ä»¶åæ ¼å¼

```python
# åœ¨ convert_word_to_markdown() å‡½æ•°ä¸­ä¿®æ”¹
base_name = os.path.splitext(os.path.basename(word_file_path))[0]
output_file = os.path.join(output_dir, f"{base_name}_converted.md")  # æ·»åŠ åç¼€
```

### 4. æ·»åŠ è¿‡æ»¤æ¡ä»¶

```python
def find_word_files(directory):
    """æŸ¥æ‰¾ç›®å½•ä¸‹æ‰€æœ‰çš„ Word æ–‡ä»¶"""
    word_extensions = ['.doc', '.docx']
    word_files = []
    
    for root, dirs, files in os.walk(directory):
        # è·³è¿‡ç‰¹å®šç›®å½•
        if 'backup' in root or 'temp' in root:
            continue
            
        for file in files:
            # è·³è¿‡ä¸´æ—¶æ–‡ä»¶
            if file.startswith('~$'):
                continue
                
            if any(file.lower().endswith(ext) for ext in word_extensions):
                word_files.append(os.path.join(root, file))
    
    return word_files
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ¨¡å—å¯¼å…¥é”™è¯¯
**é”™è¯¯**: `ModuleNotFoundError: No module named 'markitdown'`
**è§£å†³æ–¹æ¡ˆ**:
```bash
pip install markitdown
# æˆ–ä½¿ç”¨å®Œæ•´è·¯å¾„
C:\Users\16922\AppData\Local\Programs\Python\Python312\python.exe -m pip install markitdown
```

#### 2. æƒé™é”™è¯¯
**é”™è¯¯**: `PermissionError: [Errno 13] Permission denied`
**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿æ–‡ä»¶æœªè¢«å…¶ä»–ç¨‹åºæ‰“å¼€
- ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œè„šæœ¬
- æ£€æŸ¥æ–‡ä»¶å’Œç›®å½•æƒé™

#### 3. ç¼–ç é”™è¯¯
**é”™è¯¯**: `UnicodeDecodeError` æˆ–ä¹±ç 
**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿è„šæœ¬ä»¥ UTF-8 ç¼–ç ä¿å­˜
- æ£€æŸ¥ Word æ–‡æ¡£çš„è¯­è¨€è®¾ç½®
- å°è¯•é‡æ–°ä¿å­˜ Word æ–‡æ¡£

#### 4. è½¬æ¢è´¨é‡é—®é¢˜
**é—®é¢˜**: è½¬æ¢åæ ¼å¼ä¸ç†æƒ³
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥åŸ Word æ–‡æ¡£çš„æ ¼å¼
- ç¡®ä¿æ–‡æ¡£ç»“æ„æ¸…æ™°
- é¿å…å¤æ‚çš„è¡¨æ ¼å’Œå›¾å½¢

### è°ƒè¯•æ–¹æ³•

#### å¯ç”¨è¯¦ç»†è¾“å‡º
```python
# åœ¨è½¬æ¢å‡½æ•°ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
def convert_word_to_markdown(word_file_path, output_dir=None):
    try:
        print(f"  æ­£åœ¨å¤„ç†: {word_file_path}")
        md = MarkItDown()
        result = md.convert(word_file_path)
        print(f"  è½¬æ¢å†…å®¹é•¿åº¦: {len(result.text_content)} å­—ç¬¦")
        # ... å…¶ä½™ä»£ç 
```

#### å•æ–‡ä»¶æµ‹è¯•
```python
# åˆ›å»ºæµ‹è¯•è„šæœ¬
if __name__ == "__main__":
    test_file = "path/to/test.docx"
    output_file, success, error = convert_word_to_markdown(test_file)
    if success:
        print(f"æˆåŠŸ: {output_file}")
    else:
        print(f"å¤±è´¥: {error}")
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å¤§æ‰¹é‡æ–‡ä»¶å¤„ç†
```python
# æ·»åŠ è¿›åº¦æ¡ï¼ˆéœ€è¦å®‰è£… tqdmï¼‰
from tqdm import tqdm

for i, word_file in enumerate(tqdm(word_files, desc="è½¬æ¢è¿›åº¦"), 1):
    # è½¬æ¢é€»è¾‘
```

### å¹¶è¡Œå¤„ç†
```python
# ä½¿ç”¨å¤šè¿›ç¨‹åŠ é€Ÿï¼ˆé€‚åˆå¤§é‡æ–‡ä»¶ï¼‰
from multiprocessing import Pool
import multiprocessing

def parallel_convert(file_list):
    with Pool(processes=multiprocessing.cpu_count()) as pool:
        results = pool.map(convert_single_file, file_list)
    return results
```

## ğŸ”— ç›¸å…³å·¥å…·

### é…å¥—è„šæœ¬
- **æ¸…ç†è„šæœ¬**: æ¸…ç†è½¬æ¢è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ–‡ä»¶
- **éªŒè¯è„šæœ¬**: éªŒè¯è½¬æ¢ç»“æœçš„å®Œæ•´æ€§
- **ç»Ÿè®¡è„šæœ¬**: ç”Ÿæˆè½¬æ¢ç»Ÿè®¡æŠ¥å‘Š

### æ‰©å±•åŠŸèƒ½
- **GUI ç•Œé¢**: ä½¿ç”¨ tkinter åˆ›å»ºå›¾å½¢ç•Œé¢
- **é…ç½®æ–‡ä»¶**: æ”¯æŒé…ç½®æ–‡ä»¶è‡ªå®šä¹‰å‚æ•°
- **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„æ—¥å¿—è®°å½•åŠŸèƒ½

::: tip ğŸ’¡ ä½¿ç”¨å»ºè®®
1. **å¤‡ä»½åŸæ–‡ä»¶**: è½¬æ¢å‰å¤‡ä»½é‡è¦çš„ Word æ–‡æ¡£
2. **åˆ†æ‰¹å¤„ç†**: å¯¹äºå¤§é‡æ–‡ä»¶ï¼Œå»ºè®®åˆ†æ‰¹å¤„ç†
3. **æ£€æŸ¥ç»“æœ**: è½¬æ¢åæ£€æŸ¥é‡è¦æ–‡æ¡£çš„æ ¼å¼
4. **å®šæœŸæ¸…ç†**: å®šæœŸæ¸…ç†è¾“å‡ºç›®å½•é¿å…å ç”¨è¿‡å¤šç©ºé—´
:::

::: warning âš ï¸ æ³¨æ„äº‹é¡¹
- è½¬æ¢è¿‡ç¨‹ä¸­ä¸è¦ç§»åŠ¨æˆ–åˆ é™¤åŸæ–‡ä»¶
- ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´å­˜å‚¨è½¬æ¢ç»“æœ
- å¤æ‚æ ¼å¼çš„æ–‡æ¡£å¯èƒ½éœ€è¦æ‰‹åŠ¨è°ƒæ•´
- å›¾ç‰‡å’Œè¡¨æ ¼çš„è½¬æ¢æ•ˆæœå¯èƒ½æœ‰é™
:::

---

*æœ€åæ›´æ–°: 2024å¹´12æœˆ*