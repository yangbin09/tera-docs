# æœåŠ¡å™¨å·¥å…· ğŸ–¥ï¸

è¿™é‡Œæ”¶é›†äº†å„ç§æœåŠ¡å™¨é…ç½®ã€è¿ç»´å’Œç®¡ç†ç›¸å…³çš„å·¥å…·å’ŒæŒ‡å—ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç®¡ç†å’Œä¼˜åŒ–æœåŠ¡å™¨ç¯å¢ƒã€‚

## ğŸ–¥ï¸ æ“ä½œç³»ç»Ÿå®‰è£…

### [CentOS Stream 9å®‰è£…æŒ‡å—](./centos-stream-9-installation-guide.md)
å®Œæ•´çš„CentOS Stream 9ç³»ç»Ÿå®‰è£…æ•™ç¨‹ï¼š
- ğŸ’¿ é•œåƒæ–‡ä»¶ä¸‹è½½å’Œé€‰æ‹©æŒ‡å—
- âš™ï¸ VMwareè™šæ‹Ÿæœºç¯å¢ƒé…ç½®
- ğŸ”§ ç³»ç»Ÿå®‰è£…è¯¦ç»†æ­¥éª¤è¯´æ˜
- ğŸŒ ç½‘ç»œé…ç½®å’Œè¿æ¥è®¾ç½®
- ğŸ” ç”¨æˆ·æƒé™å’Œå®‰å…¨é…ç½®
- ğŸ“‹ å®‰è£…åçš„ç³»ç»Ÿä¼˜åŒ–å»ºè®®

## ğŸŒ WebæœåŠ¡å™¨

### [NginxåŸºç¡€çŸ¥è¯†è¯¦è§£](./nginx-basics-guide.md)
é«˜æ€§èƒ½WebæœåŠ¡å™¨æ ¸å¿ƒæ¦‚å¿µä¸å®è·µï¼š
- ğŸ—ï¸ Nginxæ¶æ„åŸç†å’Œå·¥ä½œæœºåˆ¶
- âš™ï¸ é…ç½®æ–‡ä»¶è¯¦è§£å’Œæœ€ä½³å®è·µ
- âš–ï¸ è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†é…ç½®
- ğŸš€ æ€§èƒ½ä¼˜åŒ–å’Œæ•…éšœæ’æŸ¥
- ğŸ”’ å®‰å…¨é…ç½®å’Œè®¿é—®æ§åˆ¶
- ğŸ“Š ç›‘æ§å’Œæ—¥å¿—ç®¡ç†

## ğŸ¯ æœåŠ¡å™¨å·¥å…·åˆ†ç±»

### æ“ä½œç³»ç»Ÿ
| ç³»ç»Ÿ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ | å­¦ä¹ éš¾åº¦ |
|------|------|---------|---------|
| CentOS Stream 9 | ç¨³å®šã€ä¼ä¸šçº§ | ç”Ÿäº§æœåŠ¡å™¨ã€ä¼ä¸šåº”ç”¨ | â­â­â­ |
| Ubuntu Server | æ˜“ç”¨ã€ç¤¾åŒºæ”¯æŒå¥½ | å¼€å‘ç¯å¢ƒã€äº‘æœåŠ¡å™¨ | â­â­ |
| RHEL | å•†ä¸šæ”¯æŒã€é«˜ç¨³å®šæ€§ | å…³é”®ä¸šåŠ¡ç³»ç»Ÿ | â­â­â­â­ |

### WebæœåŠ¡å™¨
| å·¥å…· | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ | å­¦ä¹ éš¾åº¦ |
|------|------|---------|---------|
| Nginx | é«˜æ€§èƒ½ã€ä½å†…å­˜ | é«˜å¹¶å‘ã€åå‘ä»£ç† | â­â­â­ |
| Apache | åŠŸèƒ½ä¸°å¯Œã€æ¨¡å—åŒ– | ä¼ ç»ŸWebæœåŠ¡ | â­â­â­â­ |
| Caddy | è‡ªåŠ¨HTTPSã€ç®€å•é…ç½® | å°å‹é¡¹ç›®ã€å¿«é€Ÿéƒ¨ç½² | â­â­ |

### è´Ÿè½½å‡è¡¡
| å·¥å…· | ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| Nginx | è½¯ä»¶è´Ÿè½½å‡è¡¡ | è½»é‡ã€é«˜æ•ˆ | ä¸­å°å‹åº”ç”¨ |
| HAProxy | ä¸“ä¸šè´Ÿè½½å‡è¡¡ | åŠŸèƒ½å¼ºå¤§ | å¤§å‹åº”ç”¨ |
| Cloudflare | CDNè´Ÿè½½å‡è¡¡ | å…¨çƒåˆ†å¸ƒ | å…¨çƒåŒ–åº”ç”¨ |

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

### NginxåŸºç¡€é…ç½®
```nginx
# åŸºç¡€WebæœåŠ¡å™¨é…ç½®
server {
    listen 80;
    server_name example.com;
    root /var/www/html;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

### åå‘ä»£ç†é…ç½®
```nginx
# APIåå‘ä»£ç†
location /api/ {
    proxy_pass http://localhost:3000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
}
```

### è´Ÿè½½å‡è¡¡é…ç½®
```nginx
# è´Ÿè½½å‡è¡¡é…ç½®
upstream backend {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

server {
    listen 80;
    location / {
        proxy_pass http://backend;
    }
}
```

## ğŸ”§ é«˜çº§é…ç½®

### SSL/HTTPSé…ç½®
```nginx
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/certificate.crt;
    ssl_certificate_key /path/to/private.key;
    
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
}
```

### ç¼“å­˜é…ç½®
```nginx
# é™æ€èµ„æºç¼“å­˜
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

# ä»£ç†ç¼“å­˜
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m;

location / {
    proxy_cache my_cache;
    proxy_cache_valid 200 1h;
    proxy_pass http://backend;
}
```

### å®‰å…¨é…ç½®
```nginx
# å®‰å…¨å¤´è®¾ç½®
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header X-Content-Type-Options "nosniff" always;

# é™åˆ¶è¯·æ±‚é¢‘ç‡
limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s;

location /login {
    limit_req zone=login burst=5;
    proxy_pass http://backend;
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿçº§ä¼˜åŒ–
1. **å†…æ ¸å‚æ•°è°ƒä¼˜**
   ```bash
   # å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
   ulimit -n 65535
   
   # è°ƒæ•´TCPå‚æ•°
   echo 'net.core.somaxconn = 65535' >> /etc/sysctl.conf
   ```

2. **Nginxå·¥ä½œè¿›ç¨‹ä¼˜åŒ–**
   ```nginx
   # è®¾ç½®å·¥ä½œè¿›ç¨‹æ•°ä¸ºCPUæ ¸å¿ƒæ•°
   worker_processes auto;
   
   # æ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°
   events {
       worker_connections 1024;
       use epoll;
   }
   ```

### åº”ç”¨çº§ä¼˜åŒ–
1. **å¯ç”¨Gzipå‹ç¼©**
   ```nginx
   gzip on;
   gzip_vary on;
   gzip_min_length 1024;
   gzip_types text/plain text/css application/json application/javascript;
   ```

2. **å¼€å¯Sendfile**
   ```nginx
   sendfile on;
   tcp_nopush on;
   tcp_nodelay on;
   ```

## ğŸ” ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç®¡ç†
```nginx
# è®¿é—®æ—¥å¿—æ ¼å¼
log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                '$status $body_bytes_sent "$http_referer" '
                '"$http_user_agent" "$http_x_forwarded_for"';

access_log /var/log/nginx/access.log main;
error_log /var/log/nginx/error.log warn;
```

### çŠ¶æ€ç›‘æ§
```nginx
# å¯ç”¨çŠ¶æ€é¡µé¢
location /nginx_status {
    stub_status on;
    access_log off;
    allow 127.0.0.1;
    deny all;
}
```

### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥Nginxé…ç½®
nginx -t

# é‡æ–°åŠ è½½é…ç½®
nginx -s reload

# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
ps aux | grep nginx
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **502 Bad Gateway**
   - åç«¯æœåŠ¡æœªå¯åŠ¨
   - é˜²ç«å¢™é˜»æ­¢è¿æ¥
   - è¶…æ—¶è®¾ç½®è¿‡çŸ­

2. **403 Forbidden**
   - æ–‡ä»¶æƒé™é—®é¢˜
   - ç›®å½•ç´¢å¼•è¢«ç¦ç”¨
   - SELinuxç­–ç•¥é™åˆ¶

3. **504 Gateway Timeout**
   - åç«¯å“åº”æ—¶é—´è¿‡é•¿
   - ä»£ç†è¶…æ—¶è®¾ç½®è¿‡çŸ­
   - ç½‘ç»œè¿æ¥é—®é¢˜

### è°ƒè¯•æŠ€å·§
1. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**
   ```bash
   tail -f /var/log/nginx/error.log
   ```

2. **æµ‹è¯•é…ç½®æ–‡ä»¶**
   ```bash
   nginx -t -c /etc/nginx/nginx.conf
   ```

3. **æ£€æŸ¥ç«¯å£å ç”¨**
   ```bash
   netstat -tlnp | grep :80
   ```

## ğŸ“š å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Nginxå®˜æ–¹æ–‡æ¡£](https://nginx.org/en/docs/)
- [Nginxé…ç½®ç¤ºä¾‹](https://www.nginx.com/resources/wiki/)

### å®ç”¨å·¥å…·
- [Nginxé…ç½®ç”Ÿæˆå™¨](https://nginxconfig.io/)
- [SSLé…ç½®æµ‹è¯•](https://www.ssllabs.com/ssltest/)
- [æ€§èƒ½æµ‹è¯•å·¥å…·](https://httpd.apache.org/docs/2.4/programs/ab.html)

### ç¤¾åŒºèµ„æº
- [Nginxä¸­æ–‡æ–‡æ¡£](https://nginx.org/cn/docs/)
- [è¿ç»´ç¤¾åŒº](https://www.ops-coffee.cn/)

## ğŸ‰ å®é™…åº”ç”¨æ¡ˆä¾‹

### é™æ€ç½‘ç«™æ‰˜ç®¡
- ä¸ªäººåšå®¢éƒ¨ç½²
- ä¼ä¸šå®˜ç½‘æ‰˜ç®¡
- æ–‡æ¡£ç½‘ç«™å‘å¸ƒ

### APIç½‘å…³
- å¾®æœåŠ¡æ¶æ„
- APIç‰ˆæœ¬ç®¡ç†
- è¯·æ±‚è·¯ç”±åˆ†å‘

### è´Ÿè½½å‡è¡¡
- é«˜å¯ç”¨æ¶æ„
- æµé‡åˆ†å‘
- æ•…éšœè½¬ç§»

### CDNåŠ é€Ÿ
- é™æ€èµ„æºåŠ é€Ÿ
- å…¨çƒå†…å®¹åˆ†å‘
- ç¼“å­˜ä¼˜åŒ–

::: tip ğŸ’¡ è¿ç»´æç¤º
æœåŠ¡å™¨é…ç½®éœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è¿›è¡Œè°ƒä¼˜ï¼Œå»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒå……åˆ†éªŒè¯åå†åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒã€‚
:::

::: warning âš ï¸ å®‰å…¨æé†’
æœåŠ¡å™¨å®‰å…¨é…ç½®è‡³å…³é‡è¦ï¼ŒåŒ…æ‹¬é˜²ç«å¢™è®¾ç½®ã€SSLè¯ä¹¦é…ç½®ã€è®¿é—®æ§åˆ¶ç­‰ï¼ŒåŠ¡å¿…é‡è§†å®‰å…¨é˜²æŠ¤ã€‚
:::